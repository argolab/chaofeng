

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>chaofeng.ui.inputs &mdash; cháofēng 0.09 documentation</title>
    
    <link rel="stylesheet" href="../../../static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.09',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../static/jquery.js"></script>
    <script type="text/javascript" src="../../../static/underscore.js"></script>
    <script type="text/javascript" src="../../../static/doctools.js"></script>
    <link rel="top" title="cháofēng 0.09 documentation" href="../../../index.html" />
    <link rel="up" title="chaofeng" href="../../chaofeng.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../../../index.html">cháofēng 0.09 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../chaofeng.html" accesskey="U">chaofeng</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for chaofeng.ui.inputs</h1><div class="highlight"><pre>
<span class="kn">from</span> <span class="nn">baseui</span> <span class="kn">import</span> <span class="n">BaseUI</span>
<span class="kn">import</span> <span class="nn">chaofeng.ascii</span> <span class="kn">as</span> <span class="nn">ac</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">uiexception</span> <span class="kn">import</span> <span class="o">*</span>

<div class="viewcode-block" id="SubmitInterrupt"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.SubmitInterrupt">[docs]</a><span class="k">class</span> <span class="nc">SubmitInterrupt</span><span class="p">(</span><span class="n">BaseUIInterrupt</span><span class="p">):</span><span class="k">pass</span>
</div>
<div class="viewcode-block" id="BaseInput"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseInput">[docs]</a><span class="k">class</span> <span class="nc">BaseInput</span><span class="p">(</span><span class="n">BaseUI</span><span class="p">):</span>

    <span class="n">is_destory_screen</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">termitor</span> <span class="o">=</span> <span class="n">ac</span><span class="o">.</span><span class="n">ks_finish</span>

    <span class="sd">u&#39;&#39;&#39;</span>
<span class="sd">    Base Inputer for input text.</span>
<span class="sd">    Will not print any thing during it run.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">key_maps</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">ac</span><span class="o">.</span><span class="n">k_delete</span> <span class="p">:</span> <span class="s">u&quot;delete&quot;</span><span class="p">,</span>
        <span class="n">ac</span><span class="o">.</span><span class="n">k_backspace</span> <span class="p">:</span> <span class="s">u&quot;delete&quot;</span><span class="p">,</span>
        <span class="p">}</span>

<div class="viewcode-block" id="BaseInput.init"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseInput.init">[docs]</a>    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buffer_size</span><span class="o">=</span><span class="mi">78</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer_size</span> <span class="o">=</span> <span class="n">buffer_size</span>
            </div>
<div class="viewcode-block" id="BaseInput.set_buf"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseInput.set_buf">[docs]</a>    <span class="k">def</span> <span class="nf">set_buf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buf</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">buf</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer_size</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="n">maxlen</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer_size</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
<div class="viewcode-block" id="BaseInput.restore_screen"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseInput.restore_screen">[docs]</a>    <span class="k">def</span> <span class="nf">restore_screen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">u&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="BaseInput.do_command"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseInput.do_command">[docs]</a>    <span class="k">def</span> <span class="nf">do_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">command</span> <span class="p">:</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">)()</span>
</div>
<div class="viewcode-block" id="BaseInput.real_read"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseInput.real_read">[docs]</a>    <span class="k">def</span> <span class="nf">real_read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">read_secret</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="BaseInput.fetch_str"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseInput.fetch_str">[docs]</a>    <span class="k">def</span> <span class="nf">fetch_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">u&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
</div>
    <span class="n">fetch</span> <span class="o">=</span> <span class="n">fetch_str</span>

<div class="viewcode-block" id="BaseInput.insert_char"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseInput.insert_char">[docs]</a>    <span class="k">def</span> <span class="nf">insert_char</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BaseInput.push"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseInput.push">[docs]</a>    <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">char</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">termitor</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TermitorInputInterrupt</span>
        <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="n">ac</span><span class="o">.</span><span class="n">k_ctrl_c</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SkipInputInterrupt</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_maps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmd</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">do_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">acceptable</span><span class="p">(</span><span class="n">char</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insert_char</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BaseInput.acceptable"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseInput.acceptable">[docs]</a>    <span class="k">def</span> <span class="nf">acceptable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>  <span class="c">##################### Need to reload.</span>
        <span class="k">return</span> <span class="bp">True</span>
            </div>
<div class="viewcode-block" id="BaseInput.read"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseInput.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">prompt</span><span class="p">,</span> <span class="n">termitor</span><span class="p">):</span>
        <span class="sd">u&#39;&#39;&#39;</span>
<span class="sd">        Read a string from screen. Return the result when find a string in termitor. Return</span>
<span class="sd">        `False` when recv a Ctrl+c.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">prompt</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="n">buf</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_buf</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">termitor</span> <span class="o">=</span> <span class="n">termitor</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">char</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_read</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">TermitorInputInterrupt</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">SkipInputInterrupt</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">False</span><span class="p">;</span>
</div>
<div class="viewcode-block" id="BaseInput.delete"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseInput.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</div></div>
<div class="viewcode-block" id="VisableInput"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.VisableInput">[docs]</a><span class="k">class</span> <span class="nc">VisableInput</span><span class="p">(</span><span class="n">BaseInput</span><span class="p">):</span>

<div class="viewcode-block" id="VisableInput.insert_char"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.VisableInput.insert_char">[docs]</a>    <span class="k">def</span> <span class="nf">insert_char</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">VisableInput</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">insert_char</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="VisableInput.acceptable"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.VisableInput.acceptable">[docs]</a>    <span class="k">def</span> <span class="nf">acceptable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="VisableInput.delete"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.VisableInput.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">VisableInput</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">data</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="n">backspace</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">data</span>
</div>
<div class="viewcode-block" id="VisableInput.read"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.VisableInput.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buf</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">prompt</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">termitor</span><span class="o">=</span><span class="n">ac</span><span class="o">.</span><span class="n">ks_finish</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">VisableInput</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">prompt</span><span class="p">,</span> <span class="n">termitor</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="VisableInput.readln"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.VisableInput.readln">[docs]</a>    <span class="k">def</span> <span class="nf">readln</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buf</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">prompt</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">termitor</span><span class="o">=</span><span class="n">ac</span><span class="o">.</span><span class="n">ks_finish</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">VisableInput</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">prompt</span><span class="p">,</span> <span class="n">termitor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">u&#39;</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>
    </div></div>
<div class="viewcode-block" id="EastAsiaTextInput"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.EastAsiaTextInput">[docs]</a><span class="k">class</span> <span class="nc">EastAsiaTextInput</span><span class="p">(</span><span class="n">VisableInput</span><span class="p">):</span>

<div class="viewcode-block" id="EastAsiaTextInput.acceptable"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.EastAsiaTextInput.acceptable">[docs]</a>    <span class="k">def</span> <span class="nf">acceptable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u_data</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ac</span><span class="o">.</span><span class="n">is_safe_char</span><span class="p">(</span><span class="n">u_data</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EastAsiaTextInput.delete"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.EastAsiaTextInput.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">VisableInput</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span> <span class="c"># !!! ugly but important</span>
        <span class="k">if</span> <span class="n">data</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="n">srcwidth</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="n">ac</span><span class="o">.</span><span class="n">backspace</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">data</span>
    </div></div>
<div class="viewcode-block" id="Password"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.Password">[docs]</a><span class="k">class</span> <span class="nc">Password</span><span class="p">(</span><span class="n">BaseInput</span><span class="p">):</span>

<div class="viewcode-block" id="Password.insert_char"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.Password.insert_char">[docs]</a>    <span class="k">def</span> <span class="nf">insert_char</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Password</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">insert_char</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">u&#39;*&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Password.acceptable"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.Password.acceptable">[docs]</a>    <span class="k">def</span> <span class="nf">acceptable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Password.delete"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.Password.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Password</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">data</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="n">backspace</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">data</span>
    </div>
<div class="viewcode-block" id="Password.read"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.Password.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prompt</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">termitor</span><span class="o">=</span><span class="n">ac</span><span class="o">.</span><span class="n">ks_finish</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Password</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">,</span> <span class="n">termitor</span><span class="o">=</span><span class="n">termitor</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Password.readln"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.Password.readln">[docs]</a>    <span class="k">def</span> <span class="nf">readln</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prompt</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Password</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">,</span> <span class="n">termitor</span><span class="o">=</span><span class="n">ac</span><span class="o">.</span><span class="n">ks_finish</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">u&#39;</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>
</div></div>
<div class="viewcode-block" id="DatePicker"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.DatePicker">[docs]</a><span class="k">class</span> <span class="nc">DatePicker</span><span class="p">(</span><span class="n">BaseInput</span><span class="p">):</span>

    <span class="n">str_format</span> <span class="o">=</span> <span class="s">u&#39;%Y-%m-</span><span class="si">%d</span><span class="s">&#39;</span>
    <span class="n">seq_bit</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<div class="viewcode-block" id="DatePicker.init"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.DatePicker.init">[docs]</a>    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DatePicker</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="DatePicker.set_from_date"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.DatePicker.set_from_date">[docs]</a>    <span class="k">def</span> <span class="nf">set_from_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_buf</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">u&quot;%Y-%m-</span><span class="si">%d</span><span class="s">&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
<div class="viewcode-block" id="DatePicker.acceptable"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.DatePicker.acceptable">[docs]</a>    <span class="k">def</span> <span class="nf">acceptable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">u&#39;0&#39;</span><span class="o">&lt;=</span> <span class="n">data</span> <span class="o">&lt;=</span> <span class="s">u&#39;9&#39;</span>
</div>
<div class="viewcode-block" id="DatePicker.insert_char"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.DatePicker.insert_char">[docs]</a>    <span class="k">def</span> <span class="nf">insert_char</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
        <span class="k">if</span>  <span class="n">l</span> <span class="o">&lt;=</span> <span class="mi">9</span> <span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">DatePicker</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">insert_char</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq_bit</span><span class="p">:</span>
                <span class="nb">super</span><span class="p">(</span><span class="n">DatePicker</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">insert_char</span><span class="p">(</span><span class="s">u&#39;-&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">u&#39;-&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="DatePicker.restore_screen"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.DatePicker.restore_screen">[docs]</a>    <span class="k">def</span> <span class="nf">restore_screen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fetch_str</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="DatePicker.fetch_str"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.DatePicker.fetch_str">[docs]</a>    <span class="k">def</span> <span class="nf">fetch_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">u&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="DatePicker.fetch"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.DatePicker.fetch">[docs]</a>    <span class="k">def</span> <span class="nf">fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fetch_str</span><span class="p">(),</span>
                                              <span class="bp">self</span><span class="o">.</span><span class="n">str_format</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="DatePicker.read"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.DatePicker.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prompt</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">buf</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">termitor</span><span class="o">=</span><span class="n">ac</span><span class="o">.</span><span class="n">ks_finish</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">DatePicker</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">prompt</span><span class="p">,</span> <span class="n">termitor</span><span class="o">=</span><span class="n">termitor</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="DatePicker.readln"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.DatePicker.readln">[docs]</a>    <span class="k">def</span> <span class="nf">readln</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prompt</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">buf</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">DatePicker</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">prompt</span><span class="p">,</span> <span class="n">termitor</span><span class="o">=</span><span class="n">ac</span><span class="o">.</span><span class="n">ks_finish</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">u&#39;</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>
</div>
<div class="viewcode-block" id="DatePicker.delete"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.DatePicker.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">DatePicker</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="n">backspace</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">data</span>
</div></div>
<div class="viewcode-block" id="ColMenu"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.ColMenu">[docs]</a><span class="k">class</span> <span class="nc">ColMenu</span><span class="p">(</span><span class="n">BaseUI</span><span class="p">):</span>

    <span class="n">is_destory_screen</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="n">key_maps</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">ac</span><span class="o">.</span><span class="n">k_down</span> <span class="p">:</span> <span class="s">u&quot;move_down&quot;</span><span class="p">,</span>
        <span class="n">ac</span><span class="o">.</span><span class="n">k_up</span> <span class="p">:</span> <span class="s">u&quot;move_up&quot;</span><span class="p">,</span>
        <span class="n">ac</span><span class="o">.</span><span class="n">k_left</span> <span class="p">:</span> <span class="s">u&quot;move_left&quot;</span><span class="p">,</span>
        <span class="n">ac</span><span class="o">.</span><span class="n">k_right</span> <span class="p">:</span> <span class="s">u&quot;move_right&quot;</span><span class="p">,</span>
        <span class="p">}</span>

<div class="viewcode-block" id="ColMenu.init"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.ColMenu.init">[docs]</a>    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shortcuts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vlaues</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="p">[]</span>
</div>
<div class="viewcode-block" id="ColMenu.setup"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.ColMenu.setup">[docs]</a>    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s">u&#39;&#39;</span><span class="p">,</span> <span class="n">hover</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hover</span> <span class="o">=</span> <span class="n">hover</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="n">background</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ColMenu.set_data"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.ColMenu.set_data">[docs]</a>    <span class="k">def</span> <span class="nf">set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">real</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">shortcuts</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">real</span> <span class="o">=</span> <span class="n">real</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shortcuts</span> <span class="o">=</span> <span class="n">shortcuts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="s">u&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span> <span class="s">u&#39;</span><span class="si">%s</span><span class="s">  </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="n">move2</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
                                 <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">text</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
</div>
    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="ColMenu.tidy_data"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.ColMenu.tidy_data">[docs]</a>    <span class="k">def</span> <span class="nf">tidy_data</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])],</span> <span class="p">{},</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">args</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">)</span>
        <span class="n">text</span><span class="p">,</span> <span class="n">real</span><span class="p">,</span> <span class="n">shortcuts</span> <span class="o">=</span> <span class="n">args</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">shortcuts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">shortcuts</span><span class="p">))</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="p">[</span> <span class="n">d</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span> <span class="k">else</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span> <span class="p">]</span>
        <span class="n">sx</span><span class="p">,</span><span class="n">sy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pos</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">:</span>
                <span class="n">sx</span><span class="p">,</span><span class="n">sy</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sx</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sx</span><span class="p">,</span><span class="n">sy</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">real</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">shortcuts</span><span class="p">,</span> <span class="n">text</span>
        </div>
<div class="viewcode-block" id="ColMenu.fetch"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.ColMenu.fetch">[docs]</a>    <span class="k">def</span> <span class="nf">fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">hover</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="ColMenu.restore"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.ColMenu.restore">[docs]</a>    <span class="k">def</span> <span class="nf">restore</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="n">move2</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">hover</span><span class="p">])</span><span class="o">+</span><span class="s">u&#39;&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ColMenu.refresh_cursor"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.ColMenu.refresh_cursor">[docs]</a>    <span class="k">def</span> <span class="nf">refresh_cursor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="n">backspace</span><span class="o">+</span><span class="s">u&#39; &#39;</span><span class="o">+</span><span class="n">ac</span><span class="o">.</span><span class="n">move2</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">hover</span><span class="p">])</span><span class="o">+</span><span class="s">u&#39;&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ColMenu.refresh_cursor_gently"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.ColMenu.refresh_cursor_gently">[docs]</a>    <span class="k">def</span> <span class="nf">refresh_cursor_gently</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">((</span><span class="n">ac</span><span class="o">.</span><span class="n">move2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">hover</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">hover</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="ColMenu.send_shortcuts"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.ColMenu.send_shortcuts">[docs]</a>    <span class="k">def</span> <span class="nf">send_shortcuts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">shortcuts</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shortcuts</span><span class="p">[</span><span class="n">data</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="ColMenu.send"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.ColMenu.send">[docs]</a>    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_maps</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">key_maps</span><span class="p">[</span><span class="n">data</span><span class="p">])</span> <span class="p">:</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">key_maps</span><span class="p">[</span><span class="n">data</span><span class="p">])()</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">shortcuts</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shortcuts</span><span class="p">[</span><span class="n">data</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="ColMenu.move_down"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.ColMenu.move_down">[docs]</a>    <span class="k">def</span> <span class="nf">move_down</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hover</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">len</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hover</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_cursor</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ColMenu.move_up"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.ColMenu.move_up">[docs]</a>    <span class="k">def</span> <span class="nf">move_up</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hover</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hover</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_cursor</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ColMenu.move_left"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.ColMenu.move_left">[docs]</a>    <span class="k">def</span> <span class="nf">move_left</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="p">:</span>
            <span class="n">next_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hover</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
            <span class="k">if</span> <span class="n">next_s</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hover</span> <span class="o">=</span> <span class="n">next_s</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">refresh_cursor</span><span class="p">()</span>
                <span class="k">return</span> <span class="bp">True</span>
</div>
<div class="viewcode-block" id="ColMenu.move_right"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.ColMenu.move_right">[docs]</a>    <span class="k">def</span> <span class="nf">move_right</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="p">:</span>
            <span class="n">next_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hover</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
            <span class="k">if</span> <span class="n">next_s</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">len</span> <span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hover</span> <span class="o">=</span> <span class="n">next_s</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">refresh_cursor</span><span class="p">()</span>
                <span class="k">return</span> <span class="bp">True</span>
</div>
<div class="viewcode-block" id="ColMenu.move_to"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.ColMenu.move_to">[docs]</a>    <span class="k">def</span> <span class="nf">move_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">which</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hover</span> <span class="o">=</span> <span class="n">which</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_cursor</span><span class="p">()</span>
</div></div>
<div class="viewcode-block" id="BaseSelectUI"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseSelectUI">[docs]</a><span class="k">class</span> <span class="nc">BaseSelectUI</span><span class="p">(</span><span class="n">BaseUI</span><span class="p">):</span>

    <span class="n">is_destory_screen</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="n">hover</span> <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="BaseSelectUI.init"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseSelectUI.init">[docs]</a>    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s">u&#39;&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_background</span> <span class="o">=</span> <span class="n">background</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="n">options</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_content</span> <span class="o">=</span> <span class="s">u&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">formater</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">d</span><span class="p">)</span>
                                 <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">)])</span>
</div>
<div class="viewcode-block" id="BaseSelectUI.formater"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseSelectUI.formater">[docs]</a>    <span class="k">def</span> <span class="nf">formater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">op</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</div>
<div class="viewcode-block" id="BaseSelectUI.hook_hover"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseSelectUI.hook_hover">[docs]</a>    <span class="k">def</span> <span class="nf">hook_hover</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</div>
<div class="viewcode-block" id="BaseSelectUI.fetch"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseSelectUI.fetch">[docs]</a>    <span class="k">def</span> <span class="nf">fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BaseSelectUI.restore_screen"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseSelectUI.restore_screen">[docs]</a>    <span class="k">def</span> <span class="nf">restore_screen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="n">clear</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_background</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_content</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BaseSelectUI.push"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseSelectUI.push">[docs]</a>    <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">char</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">char</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="n">ac</span><span class="o">.</span><span class="n">k_up</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hover</span> <span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">hook_hover</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hover</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">char</span> <span class="o">==</span> <span class="n">ac</span><span class="o">.</span><span class="n">k_down</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hover</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_len</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">hook_hover</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hover</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span> <span class="o">-</span> <span class="mi">65</span>   <span class="c">####### The order</span>
                <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">g</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_len</span> <span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">hook_hover</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">ac</span><span class="o">.</span><span class="n">ks_finish</span> <span class="p">:</span>
                    <span class="k">raise</span> <span class="n">TermitorInputInterrupt</span>
                <span class="k">elif</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">ac</span><span class="o">.</span><span class="n">k_ctrl_c</span> <span class="p">:</span>
                    <span class="k">raise</span> <span class="n">SkipInputInterrupt</span>
</div>
<div class="viewcode-block" id="BaseSelectUI.read"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.BaseSelectUI.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restore_screen</span><span class="p">()</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">char</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">read_secret</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">TermitorInputInterrupt</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>

<span class="c"># class RadioButton(BaseSelectUI):</span>

<span class="c">#     hover = 0</span>
<span class="c">#     start_line = 3</span>
<span class="c">#     start_col = 5</span>
    
<span class="c">#     u&#39;&#39;&#39;</span>
<span class="c">#     options = [ (index, text) ... ]</span>
<span class="c">#     fetch : index</span>
<span class="c">#     display in form : text | &lt;&lt;NONE&gt;&gt;</span>
<span class="c">#     &#39;&#39;&#39;</span>

<span class="c">#     def init(self, options, default=None, background=u&#39;&#39;):</span>
<span class="c">#         if default is None:</span>
<span class="c">#             default = 0</span>
<span class="c">#         super(RadioButton, self).init(options, background=background)</span>
        
<span class="c">#     def formater(self, index, op):</span>
<span class="c">#         return u&#39;%s%s %s&#39; % (ac.move2(index + self.start_line, self.start_col),</span>
<span class="c">#                             chr(index+65), op)  ## +65 to covert into Upper</span>

<span class="c">#     def hook_hover(self, g):</span>
<span class="c">#         print (&#39;g&#39;, g)</span>
<span class="c">#         self.hover = g</span>
<span class="c">#         self.frame.write(ac.move2(g + self.start_line, self.start_col+2))</span>

<span class="c">#     def restore_screen(self):</span>
<span class="c">#         super(RadioButton, self).restore_screen()</span>
<span class="c">#         self.frame.write(ac.move2(self.hover + self.start_line, self.start_col+2))</span>

<span class="c">#     def fetch(self):</span>
<span class="c">#         if self._options :</span>
<span class="c">#             return self.hover</span>
<span class="c">#         else:</span>
<span class="c">#             return None</span>

<span class="c">#     def fetch_str(self):</span>
<span class="c">#         f = self.fetch()</span>
<span class="c">#         if f:</span>
<span class="c">#             return self._options[f][1]</span>
<span class="c">#         else:</span>
<span class="c">#             return u&#39;&lt;&lt;NONE&gt;&gt;&#39;</span>
</div></div>
<div class="viewcode-block" id="Form"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.Form">[docs]</a><span class="k">class</span> <span class="nc">Form</span><span class="p">(</span><span class="n">BaseUI</span><span class="p">):</span>

    <span class="sd">u&#39;&#39;&#39;</span>
<span class="sd">    data :: [( name, text, handler) ]</span>

<span class="sd">    handler may raise a ValueError, or return the value to save.</span>
<span class="sd">    &#39;&#39;&#39;</span>

<div class="viewcode-block" id="Form.init"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.Form.init">[docs]</a>    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">start_line</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">msg_line</span><span class="o">=</span><span class="mi">22</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_line</span> <span class="o">=</span> <span class="n">start_line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_line</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>
</div>
<div class="viewcode-block" id="Form.read"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.Form.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">default</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">text</span><span class="p">,</span><span class="n">handler</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">ac</span><span class="o">.</span><span class="n">move2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_line</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                                      <span class="n">ac</span><span class="o">.</span><span class="n">kill_line_n</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">),</span>
                                      <span class="n">ac</span><span class="o">.</span><span class="n">move2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_line</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">text</span><span class="p">)))</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ac</span><span class="o">.</span><span class="n">move2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_line</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                                         <span class="n">ac</span><span class="o">.</span><span class="n">kill_line</span><span class="p">]))</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readline</span><span class="p">(</span><span class="n">default</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                    <span class="k">return</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">handler</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s%s</span><span class="se">\r\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="n">move2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">msg_line</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">default</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="n">default</span>
</div>
<div class="viewcode-block" id="Form.readline"><a class="viewcode-back" href="../../../chaofeng.ui.html#chaofeng.ui.inputs.Form.readline">[docs]</a>    <span class="k">def</span> <span class="nf">readline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">acceptable</span><span class="o">=</span><span class="n">ac</span><span class="o">.</span><span class="n">is_safe_char</span><span class="p">,</span> <span class="n">finish</span><span class="o">=</span><span class="n">ac</span><span class="o">.</span><span class="n">ks_finish</span><span class="p">,</span> <span class="n">buf_size</span><span class="o">=</span><span class="mi">78</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return the string when `finish` key recv, return False while recv a k_ctrl_c</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">prefix</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">buf</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">buf</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">char</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">read_secret</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">ac</span><span class="o">.</span><span class="n">ks_delete</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">buf</span> <span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">buf</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="n">backspace</span> <span class="o">*</span> <span class="n">ac</span><span class="o">.</span><span class="n">srcwidth</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
                    <span class="k">continue</span>
            <span class="k">elif</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">finish</span> <span class="p">:</span>
                <span class="k">return</span> <span class="s">u&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">char</span> <span class="o">==</span> <span class="n">ac</span><span class="o">.</span><span class="n">k_ctrl_c</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">elif</span> <span class="n">acceptable</span><span class="p">(</span><span class="n">char</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">buf_size</span><span class="p">:</span>
                    <span class="n">buf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">u&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../../../index.html">cháofēng 0.09 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../chaofeng.html" >chaofeng</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, LTaoist.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>